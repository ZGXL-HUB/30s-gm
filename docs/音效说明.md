# 音效功能说明

## 已实现内容

1. **点击音效（全小程序按钮/选项）**  
   在 **app.js** 中已包装全局 `Page`：所有页面的**非生命周期方法**（如 `bindtap` 绑定的方法）在调用时会先播放短促点击音效（`tap.mp3`）。  
   因此**整个小程序内所有按钮、选项的点击**都会自动带 tap 音效，无需在各页面单独写 `sound.playTap()`。  
   已排除的方法（不播 tap）：`onLoad`、`onShow`、`onReady`、`onHide`、`onUnload`、`onPullDownRefresh`、`onReachBottom`、`onPageScroll`、`onShareAppMessage`、`onShareTimeline`、`onTabItemTap`、`onAddToFavorites` 等。

2. **正确率/结果界面与 Toast 音效**  
   - 全局已包装 `wx.showToast`：任意页面调用 `wx.showToast` 时会先播放 `toast.mp3`，再显示 Toast。
   - 进入**每个**正确率统计界面时都会播放一次 `toast.mp3`，覆盖的直播课环节包括：
     - 第一环节·真题预练（完成 / 跳过）
     - 第二环节·标志词识别（本组结果 / 全部完成 / 跳过）
     - 第三环节·复数形式识别（本组结果 / 全部完成 / 跳过）
     - 第四环节·正误判断（本组结果 / 全部完成 / 跳过）
     - 第五环节·单选题 es 规则（本组结果 / 全部完成 / 跳过）
     - 第六环节·模拟演练（本组结果 / 全部完成 / 跳过）
     - 第七环节·真题再练（完成 / 跳过）
     - 第八环节·帮同学找错误（完成 / 跳过）
     - 第九环节·学以致用（完成 / 跳过）
     - 第十环节·一句话卡片（核对答案后）
     - 课前真题检测（完成时）
     - 填空运用规则（完成时）
     - 关键词识别（完成时）
     - 真题填空（完成时）

## 如何让音效生效

1. **准备音频文件**  
   在 **miniprogram/sounds/** 目录下放置两个 MP3 文件：
   - **tap.mp3**：点击选项、按钮时播放（建议 100–300ms 的短音）
   - **toast.mp3**：Toast 提示、正确率/结果界面出现时播放（建议 200–500ms）

   若未放置上述文件，调用音效不会报错，只是没有声音。

2. **点击音效**  
   已通过全局 Page 包装统一处理，**无需**在业务代码里再写 `sound.playTap()`。

3. **在结果/正确率展示时加提示音**  
   在 setData 展示正确率/结果界面前调用一次：

   ```js
   sound.playToast();
   this.setData({ showResult: true, correctRate: rate, ... });
   ```

   Toast 音效已全局接管，只要调用 `wx.showToast` 就会自动播放 `toast.mp3`，无需再在业务里单独调 `sound.playToast()`（除非是只展示结果界面、不弹 Toast 的场景）。

## 技术说明

- **Tap 音效**：在 app.js 中包装了全局 `Page`，将每个页面的非生命周期方法包一层，在调用前执行 `sound.playTap()`，从而覆盖所有通过 `bindtap` 等触发的点击。
- **Toast 音效**：包装了 `wx.showToast`，调用时先播 `toast.mp3` 再显示 Toast。
- 使用微信小程序 **InnerAudioContext**，路径为包内绝对路径：`/sounds/tap.mp3`、`/sounds/toast.mp3`（对应 `miniprogram/sounds/` 下文件）。
- 音效播放失败（如文件不存在）会静默忽略，不影响页面逻辑。
- 若需静音时也不播放，可在 `miniprogram/utils/sound.js` 里将 `obeyMuteSwitch` 设为 `true`。

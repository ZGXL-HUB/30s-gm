# 映射验证测试页面使用说明

## 📋 功能说明

这个测试页面用于验证 `cloudDataLoader.js` 中的映射表与实际数据库的匹配性。

## 🚀 使用方法

### 方法1: 通过页面路径访问

1. 在微信开发者工具中，点击"编译"
2. 在控制台输入以下代码，或使用页面跳转：

```javascript
wx.navigateTo({
  url: '/pages/test-mapping-verification/index'
})
```

### 方法2: 直接在开发者工具中打开

1. 在微信开发者工具中，找到 `pages/test-mapping-verification/index.js`
2. 右键点击文件，选择"预览"
3. 或者直接在地址栏输入页面路径

## 📊 测试内容

### 测试1: 统计所有 category 唯一值

**目的**: 查看数据库中实际使用的 category 命名规范

**输出内容**:
- 所有高中题目的 category 唯一值列表
- 每个 category 的题目数量
- 每个 category 对应的 grammarPoint 示例
- 按分类分组的统计结果

**示例输出**:
```
📋 高中题库中 category 的唯一值（共 45 个）:
  "连词(1)": 120 题 (grammarPoint示例: 并列连词, 从属连词)
  "连词(2)": 95 题
  "连词综合": 0 题  ← 如果为0，说明映射表有问题
  ...
```

### 测试2: 验证关键映射

**目的**: 验证映射表中提到的关键 category 值是否能在数据库中找到

**验证的映射**:
- `"连词综合"`
- `"时态综合"`
- `"谓语综合"`
- `"冠词综合"`
- `"形容词综合"`
- `"副词综合"`
- `"名词综合"`
- `"代词综合"`
- `"动词综合"`

**输出内容**:
- 每个映射的精确匹配结果（category 完全相等）
- 模糊匹配结果（category 包含关键词）
- 匹配到的实际 category 值列表

**示例输出**:
```
📌 连词综合 (映射表目标值: "连词综合")
  精确匹配 (category = "连词综合"): 0 题
  ⚠️  精确匹配失败！
  模糊匹配 (category 包含 "连词"): 250 题
  匹配到的 category 值: 连词(1), 连词(2), 连词(3), 连词综合
```

### 测试3: 查看专题与子知识点的对应关系

**目的**: 了解如果要组一个专题，应该查询哪些 category

**分析的专题**:
- 连词
- 时态/谓语
- 冠词
- 形容词
- 副词
- 名词
- 代词
- 介词
- 动词
- 非谓语
- 从句

**输出内容**:
- 每个专题相关的所有 category
- 每个 category 的题目数量
- 主要 grammarPoint 统计
- 建议查询的 category 列表

**示例输出**:
```
📖 【连词】专题:
  共找到 250 道相关题目
  涉及 4 个不同的 category:
    - "连词(1)": 120 题
    - "连词(2)": 95 题
    - "连词(3)": 35 题
    - "连词综合": 0 题
  
  💡 建议查询的 category 列表:
    - "连词(1)" (120 题)
    - "连词(2)" (95 题)
    - "连词(3)" (35 题)
```

## 📝 查看结果

### 控制台输出

所有测试结果都会详细打印到**微信开发者工具的控制台**中，包括：

1. **完整的统计信息**
2. **详细的匹配结果**
3. **建议的查询方案**

### 页面显示

页面会显示：
- 测试进度
- 测试完成状态
- 可以导出结果到剪贴板

## 🔧 注意事项

1. **需要云开发环境**: 确保已配置云开发环境
2. **需要数据库权限**: 确保有读取 `questions` 集合的权限
3. **测试时间**: 完整测试可能需要几秒钟，请耐心等待
4. **控制台查看**: 建议打开开发者工具的控制台查看详细日志

## 📤 导出结果

点击页面上的"导出结果"按钮，可以将测试结果以 JSON 格式复制到剪贴板，方便后续分析。

## 🐛 故障排除

### 如果测试失败

1. **检查云开发配置**:
   ```javascript
   // 在 app.js 中确保已初始化
   wx.cloud.init({
     env: 'your-env-id'
   })
   ```

2. **检查数据库权限**: 确保 `questions` 集合有读取权限

3. **查看控制台错误**: 检查是否有具体的错误信息

### 如果查询结果为空

- 可能是数据库中没有对应学段（schoolLevel = 'high'）的题目
- 可能是 category 字段的命名与预期不符
- 检查数据库中的实际数据格式

## 📊 结果分析建议

根据测试结果，你可以：

1. **对比映射表**: 将测试结果与 `cloudDataLoader.js` 中的映射表对比
2. **修正映射表**: 如果发现不匹配，修正映射表的目标值
3. **更新查询逻辑**: 根据实际数据调整查询策略

## 🗑️ 测试完成后

测试完成后，可以删除这个测试页面：

1. 删除 `pages/test-mapping-verification/` 目录
2. 从 `app.json` 中移除页面路径
3. 重新编译项目

---

**创建时间**: 2025-01-XX
**用途**: 临时测试，验证映射表与实际数据库的匹配性

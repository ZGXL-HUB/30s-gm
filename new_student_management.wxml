<!-- å…¨æ–°çš„å­¦ç”Ÿç®¡ç†ç•Œé¢æ¨¡æ¿ -->
<view class="student-management-container">
  
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">å­¦ç”Ÿç®¡ç†</text>
    <view class="header-actions">
      <button class="btn btn-outline" bindtap="showUsageGuide">ä½¿ç”¨è¯´æ˜</button>
      <button class="btn btn-secondary btn-refresh" bindtap="refreshStudentList">
        <text class="btn-icon">ğŸ”„</text>
        åˆ·æ–°
      </button>
      <button class="btn btn-primary" bindtap="showCreateStudentModal">æ·»åŠ å­¦ç”Ÿ</button>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <text class="loading-text">æ­£åœ¨åŠ è½½å­¦ç”Ÿæ•°æ®...</text>
  </view>

  <!-- å­¦ç”Ÿåˆ—è¡¨ -->
  <view class="students-container" wx:else>
    
    <!-- å­¦ç”Ÿç»Ÿè®¡ä¿¡æ¯ -->
    <view class="students-stats">
      <text class="stats-text">å…± {{students.length}} åå­¦ç”Ÿ</text>
    </view>

    <!-- å­¦ç”Ÿåˆ—è¡¨ -->
    <view class="students-list">
      <view 
        class="student-card"
        wx:for="{{students}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="viewStudentDetail"
      >
        <!-- å­¦ç”ŸåŸºæœ¬ä¿¡æ¯ -->
        <view class="student-header">
          <view class="student-info">
            <text class="student-name">{{item.name}}</text>
            <text class="student-id">{{item.studentId}}</text>
          </view>
          <view class="status-badge status-{{item.status}}">
            {{item.status === 'active' ? 'æ´»è·ƒ' : 'ç¦»çº¿'}}
          </view>
        </view>

        <!-- ç­çº§ä¿¡æ¯ -->
        <view class="student-class">
          <text class="class-label">ç­çº§ï¼š</text>
          <text class="class-name">{{item.class}}</text>
        </view>

        <!-- è”ç³»æ–¹å¼ -->
        <view class="student-contact" wx:if="{{item.phone || item.email}}">
          <text class="contact-text">{{item.phone}} {{item.email}}</text>
        </view>

        <!-- å­¦ä¹ ç»Ÿè®¡ -->
        <view class="student-stats">
          <view class="stat-item">
            <text class="stat-number">{{item.completedAssignments}}/{{item.totalAssignments}}</text>
            <text class="stat-label">å®Œæˆä½œä¸š</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{item.averageAccuracy}}%</text>
            <text class="stat-label">å¹³å‡æ­£ç¡®ç‡</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{item.weakGrammarPoints.length}}</text>
            <text class="stat-label">è–„å¼±ç‚¹</text>
          </view>
        </view>

        <!-- è–„å¼±è¯­æ³•ç‚¹ -->
        <view class="weak-points" wx:if="{{item.weakGrammarPoints.length > 0}}">
          <text class="weak-points-label">è–„å¼±è¯­æ³•ç‚¹ï¼š</text>
          <view class="points-list">
            <text 
              class="point-tag"
              wx:for="{{item.weakGrammarPoints}}" 
              wx:key="*this"
            >{{item}}</text>
          </view>
        </view>

      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{students.length === 0}}">
      <text class="empty-icon">ğŸ‘¥</text>
      <text class="empty-text">æš‚æ— å­¦ç”Ÿæ•°æ®</text>
      <text class="empty-tip">ç‚¹å‡»"æ·»åŠ å­¦ç”Ÿ"æŒ‰é’®æ·»åŠ æ–°å­¦ç”Ÿ</text>
    </view>

  </view>

  <!-- åˆ›å»ºå­¦ç”Ÿå¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showCreateStudent}}">
    <view class="modal">
      <view class="modal-header">
        <text class="modal-title">æ·»åŠ å­¦ç”Ÿ</text>
        <text class="modal-close" bindtap="closeCreateStudentModal">Ã—</text>
      </view>
      
      <view class="modal-body">
        <view class="form-item">
          <text class="form-label">å­¦ç”Ÿå§“å</text>
          <input 
            class="form-input"
            type="text" 
            placeholder="è¯·è¾“å…¥å­¦ç”Ÿå§“å"
            value="{{newStudent.name}}"
            data-field="name"
            bindinput="onStudentInput"
          />
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="btn btn-secondary" bindtap="closeCreateStudentModal">å–æ¶ˆ</button>
        <button class="btn btn-primary" bindtap="createStudent">åˆ›å»º</button>
      </view>
    </view>
  </view>

  <!-- å­¦ç”Ÿè¯¦æƒ…å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showStudentDetail}}">
    <view class="modal">
      <view class="modal-header">
        <text class="modal-title">å­¦ç”Ÿè¯¦æƒ…</text>
        <text class="modal-close" bindtap="closeStudentDetail">Ã—</text>
      </view>
      
      <view class="modal-body" wx:if="{{selectedStudent}}">
        <view class="detail-section">
          <text class="detail-title">åŸºæœ¬ä¿¡æ¯</text>
          <view class="detail-item">
            <text class="detail-label">å§“åï¼š</text>
            <text class="detail-value">{{selectedStudent.name}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">å­¦å·ï¼š</text>
            <text class="detail-value">{{selectedStudent.studentId}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">ç­çº§ï¼š</text>
            <text class="detail-value">{{selectedStudent.class}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">çŠ¶æ€ï¼š</text>
            <text class="detail-value">{{selectedStudent.status === 'active' ? 'æ´»è·ƒ' : 'ç¦»çº¿'}}</text>
          </view>
        </view>

        <view class="detail-section">
          <text class="detail-title">å­¦ä¹ ç»Ÿè®¡</text>
          <view class="detail-item">
            <text class="detail-label">å®Œæˆä½œä¸šï¼š</text>
            <text class="detail-value">{{selectedStudent.completedAssignments}}/{{selectedStudent.totalAssignments}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">å¹³å‡æ­£ç¡®ç‡ï¼š</text>
            <text class="detail-value">{{selectedStudent.averageAccuracy}}%</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">è–„å¼±ç‚¹æ•°é‡ï¼š</text>
            <text class="detail-value">{{selectedStudent.weakGrammarPoints.length}}ä¸ª</text>
          </view>
        </view>

        <view class="detail-section" wx:if="{{selectedStudent.weakGrammarPoints.length > 0}}">
          <text class="detail-title">è–„å¼±è¯­æ³•ç‚¹</text>
          <view class="weak-points-detail">
            <text 
              class="weak-point-detail"
              wx:for="{{selectedStudent.weakGrammarPoints}}" 
              wx:key="*this"
            >{{item}}</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="btn btn-primary" bindtap="closeStudentDetail">å…³é—­</button>
      </view>
    </view>
  </view>

</view>

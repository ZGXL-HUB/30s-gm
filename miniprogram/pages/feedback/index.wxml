<!--意见反馈页面-->
<view class="container">
  <!-- 页面引导卡片 -->
  <page-header-guide 
    title="意见反馈"
    description="您的宝贵意见是我们改进产品的重要动力"
    tip="💡 提示：请详细描述您的反馈，我们会认真考虑并改进"
    icon="💬"
    storage-key="feedback-guide"
  />
  
  <view class="feedback-content">
    <!-- 现有功能的不足之处 -->
    <view class="feedback-section">
      <view class="section-title">现有功能的不足之处 <text class="optional">（选填）</text></view>
      <view class="section-desc">请描述您在使用现有功能时遇到的问题或不足</view>
      <textarea 
        class="feedback-textarea"
        placeholder="例如：某个功能操作不够便捷、界面显示有问题、功能响应速度慢等..."
        value="{{existingIssues}}"
        bindinput="onExistingIssuesInput"
        maxlength="500"
        show-confirm-bar="{{false}}"
      ></textarea>
      <view class="char-count">{{existingIssues.length}}/500</view>
    </view>

    <!-- 未被满足的需求 -->
    <view class="feedback-section">
      <view class="section-title">未被满足的需求 <text class="optional">（选填）</text></view>
      <view class="section-desc">请描述您希望新增的功能或改进建议</view>
      <textarea 
        class="feedback-textarea"
        placeholder="例如：希望增加某个功能、优化某个流程、添加新的学习工具等..."
        value="{{unmetNeeds}}"
        bindinput="onUnmetNeedsInput"
        maxlength="300"
        show-confirm-bar="{{false}}"
      ></textarea>
      <view class="char-count">{{unmetNeeds.length}}/300</view>
    </view>

    <!-- 提交按钮 -->
    <view class="submit-section">
      <button 
        class="submit-btn {{canSubmit ? 'active' : 'disabled'}}"
        bindtap="submitFeedback"
        disabled="{{!canSubmit}}"
      >
        {{submitting ? '提交中...' : '提交反馈'}}
      </button>
    </view>

    <!-- 查看历史记录 -->
    <view class="history-section">
      <button class="history-btn" bindtap="viewHistory">
        📋 查看我的反馈记录
      </button>
    </view>
  </view>

  <!-- 提交成功模态框 -->
  <view class="modal-overlay" wx:if="{{showSuccessModal}}" bindtap="hideSuccessModal">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <view class="modal-title">反馈提交成功</view>
        <view class="modal-close" bindtap="hideSuccessModal">×</view>
      </view>
      
      <view class="modal-body">
        <view class="success-icon">✅</view>
        <view class="success-message">
          <view class="success-title">感谢您的反馈！</view>
          <view class="success-desc">
            我们已收到您的反馈，反馈编号：{{feedbackId}}<br/>
            我们会在3个工作日内处理并回复您
          </view>
        </view>
        
        <view class="modal-actions">
          <button class="modal-btn secondary" bindtap="hideSuccessModal">继续反馈</button>
          <button class="modal-btn primary" bindtap="goBack">返回首页</button>
        </view>
      </view>
    </view>
  </view>
</view>

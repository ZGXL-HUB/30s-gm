<!-- æ•™å¸ˆç«¯ä½œä¸šç®¡ç†é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">æˆ‘çš„ä½œä¸š</text>
    <button class="create-btn" bindtap="createAssignment">+ åˆ›å»ºä½œä¸š</button>
  </view>

  <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
  <view class="tabs">
    <view 
      class="tab {{currentTab === 'active' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="active"
    >
      è¿›è¡Œä¸­ ({{getCurrentAssignments().length}})
    </view>
    <view 
      class="tab {{currentTab === 'completed' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="completed"
    >
      å·²å®Œæˆ ({{getCurrentAssignments().length}})
    </view>
    <view 
      class="tab {{currentTab === 'expired' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="expired"
    >
      å·²è¿‡æœŸ ({{getCurrentAssignments().length}})
    </view>
  </view>

  <!-- ä½œä¸šåˆ—è¡¨ -->
  <view class="assignment-list" wx:if="{{!loading}}">
    <view 
      wx:for="{{getCurrentAssignments()}}" 
      wx:key="_id" 
      class="assignment-item"
    >
      <view class="assignment-header">
        <text class="assignment-title">{{item.title}}</text>
        <text class="assignment-status {{item.status}}">{{item.statusText}}</text>
      </view>
      
      <view class="assignment-info">
        <view class="info-item">
          <text class="info-label">æˆªæ­¢æ—¶é—´ï¼š</text>
          <text class="info-value">{{formatTime(item.deadline)}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">é¢˜ç›®æ•°é‡ï¼š</text>
          <text class="info-value">{{item.questions.length}}é¢˜</text>
        </view>
        <view class="info-item" wx:if="{{item.studentCount > 0}}">
          <text class="info-label">å®Œæˆæƒ…å†µï¼š</text>
          <text class="info-value">{{item.completionRate}}% ({{item.studentCount}}äºº)</text>
        </view>
        <view class="info-item" wx:if="{{item.averageAccuracy > 0}}">
          <text class="info-label">å¹³å‡æ­£ç¡®ç‡ï¼š</text>
          <text class="info-value">{{item.averageAccuracy}}%</text>
        </view>
      </view>
      
      <view class="assignment-actions">
        <button 
          class="action-btn secondary" 
          bindtap="viewAssignmentDetail" 
          data-id="{{item._id}}"
        >
          æŸ¥çœ‹è¯¦æƒ…
        </button>
        <button 
          class="action-btn primary" 
          bindtap="showExportModal" 
          data-id="{{item._id}}"
          wx:if="{{item.status === 'completed' || item.studentCount > 0}}"
        >
          ç”ŸæˆPPT
        </button>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{getCurrentAssignments().length === 0}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">æš‚æ— {{currentTab === 'active' ? 'è¿›è¡Œä¸­' : currentTab === 'completed' ? 'å·²å®Œæˆ' : 'å·²è¿‡æœŸ'}}çš„ä½œä¸š</text>
      <button class="empty-btn" bindtap="createAssignment" wx:if="{{currentTab === 'active'}}">
        åˆ›å»ºç¬¬ä¸€ä¸ªä½œä¸š
      </button>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- å¯¼å‡ºæ ¼å¼é€‰æ‹©å¼¹çª— -->
  <view class="export-modal" wx:if="{{showExportModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">é€‰æ‹©å¯¼å‡ºæ ¼å¼</text>
        <text class="modal-close" bindtap="closeExportModal">Ã—</text>
      </view>
      
      <view class="modal-body">
        <view class="format-options">
          <view 
            class="format-option {{exportFormat === 'ppt' ? 'selected' : ''}}"
            bindtap="selectExportFormat"
            data-format="ppt"
          >
            <view class="format-icon">ğŸ“Š</view>
            <view class="format-info">
              <text class="format-name">PPTæ ¼å¼</text>
              <text class="format-desc">é€‚åˆè¯¾å ‚è®²è¯„ï¼Œä¸æ˜¾ç¤ºç­”æ¡ˆ</text>
            </view>
            <view class="format-radio" wx:if="{{exportFormat === 'ppt'}}">âœ“</view>
          </view>
          
          <view 
            class="format-option {{exportFormat === 'word' ? 'selected' : ''}}"
            bindtap="selectExportFormat"
            data-format="word"
          >
            <view class="format-icon">ğŸ“„</view>
            <view class="format-info">
              <text class="format-name">Wordæ ¼å¼</text>
              <text class="format-desc">é€‚åˆæ‰“å°åˆ†å‘ï¼Œæ˜¾ç¤ºç­”æ¡ˆå’Œè§£æ</text>
            </view>
            <view class="format-radio" wx:if="{{exportFormat === 'word'}}">âœ“</view>
          </view>
        </view>
        
        <view class="assignment-info" wx:if="{{currentAssignment}}">
          <text class="info-title">ä½œä¸šä¿¡æ¯ï¼š</text>
          <text class="info-text">{{currentAssignment.title}}</text>
          <text class="info-text">é¢˜ç›®æ•°é‡ï¼š{{currentAssignment.questions.length}}é¢˜</text>
        </view>
      </view>
      
      <view class="modal-actions">
        <button class="btn btn-secondary" bindtap="closeExportModal">å–æ¶ˆ</button>
        <button class="btn btn-primary" bindtap="generateExport">ç”Ÿæˆæ–‡ä»¶</button>
      </view>
    </view>
  </view>
</view>

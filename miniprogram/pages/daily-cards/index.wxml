<!--æ¯æ—¥å¡ç‰‡ç³»ç»Ÿé¡µé¢-->
<view class="container">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header-section">
    <view class="user-info">
      <view class="user-level">{{userLevel}}</view>
      <view class="streak-info">
        <text class="streak-icon">ğŸ”¥</text>
        <text class="streak-days">è¿ç»­å­¦ä¹ {{streakDays}}å¤©</text>
      </view>
    </view>
    
    <view class="progress-section">
      <view class="progress-title">ä»Šæ—¥è¿›åº¦</view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{todayProgress / 200 * 100}}%"></view>
      </view>
      <view class="progress-text">{{todayProgress}}/200 XP</view>
    </view>
  </view>

  <!-- ä»Šæ—¥å¡ç‰‡åˆ—è¡¨ -->
  <view class="cards-section">
    <view class="section-title">
      <text class="title-text">ğŸ“… ä»Šæ—¥ä»»åŠ¡</text>
      <text class="refresh-btn" bindtap="refreshTasks">ğŸ”„</text>
    </view>
    
    <view class="cards-container" wx:if="{{!loading}}">
      <view 
        class="daily-card {{item.isUnlocked ? 'unlocked' : 'locked'}} {{item.isCompleted ? 'completed' : ''}}"
        wx:for="{{todayCards}}" 
        wx:key="id"
        data-card-id="{{item.id}}"
        bindtap="onCardTap"
      >
        <view class="card-header">
          <view class="card-icon">{{item.icon}}</view>
          <view class="card-order">{{item.order}}</view>
        </view>
        
        <view class="card-content">
          <view class="card-title">{{item.title}}</view>
          <view class="card-description">{{item.description}}</view>
          
          <view class="card-info">
            <view class="difficulty-badge difficulty-{{item.difficulty}}">
              {{item.difficulty === 'easy' ? 'ç®€å•' : item.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾'}}
            </view>
            <view class="time-info">â±ï¸ {{item.estimatedTime}}</view>
          </view>
        </view>
        
        <view class="card-footer">
          <view class="xp-reward">+{{item.xpReward}} XP</view>
          <view class="card-status">
            <text wx:if="{{item.isCompleted}}" class="status-completed">âœ“ å·²å®Œæˆ</text>
            <text wx:elif="{{item.isUnlocked}}" class="status-unlocked">å¼€å§‹ä»»åŠ¡</text>
            <text wx:else class="status-locked">ğŸ”’ æœªè§£é”</text>
          </view>
        </view>
        
        <!-- é”å®šé®ç½© -->
        <view class="lock-overlay" wx:if="{{!item.isUnlocked}}">
          <view class="lock-icon">ğŸ”’</view>
          <view class="unlock-condition">{{item.unlockCondition}}</view>
        </view>
        
        <!-- å®Œæˆé®ç½© -->
        <view class="complete-overlay" wx:if="{{item.isCompleted}}">
          <view class="complete-icon">ğŸ‰</view>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-container" wx:if="{{loading}}">
      <view class="loading-text">æ­£åœ¨ç”Ÿæˆä»Šæ—¥ä»»åŠ¡...</view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="viewAchievements">
      ğŸ† æŸ¥çœ‹æˆå°±
    </button>
    <button class="action-btn primary" bindtap="refreshTasks">
      ğŸ”„ åˆ·æ–°ä»»åŠ¡
    </button>
  </view>
</view>

<!-- å¡ç‰‡è¯¦æƒ…å¼¹çª— -->
<view class="card-detail-modal" wx:if="{{showCardDetail}}">
  <view class="modal-overlay" bindtap="closeCardDetail"></view>
  <view class="modal-content">
    <view class="modal-header">
      <view class="modal-title">{{selectedCard.title}}</view>
      <view class="modal-close" bindtap="closeCardDetail">âœ•</view>
    </view>
    
    <view class="modal-body">
      <view class="detail-icon">{{selectedCard.icon}}</view>
      <view class="detail-description">{{selectedCard.description}}</view>
      
      <view class="detail-info">
        <view class="info-item">
          <text class="info-label">éš¾åº¦ï¼š</text>
          <text class="info-value difficulty-{{selectedCard.difficulty}}">
            {{selectedCard.difficulty === 'easy' ? 'ç®€å•' : selectedCard.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾'}}
          </text>
        </view>
        <view class="info-item">
          <text class="info-label">é¢„è®¡æ—¶é—´ï¼š</text>
          <text class="info-value">{{selectedCard.estimatedTime}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">ç»éªŒå¥–åŠ±ï¼š</text>
          <text class="info-value xp-value">+{{selectedCard.xpReward}} XP</text>
        </view>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="modal-btn secondary" bindtap="closeCardDetail">
        å–æ¶ˆ
      </button>
      <button class="modal-btn primary" bindtap="startCardTask">
        å¼€å§‹ä»»åŠ¡
      </button>
    </view>
  </view>
</view>

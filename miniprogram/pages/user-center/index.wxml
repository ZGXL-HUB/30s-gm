<!-- pages/me/index.wxml -->
<view class="page_container">
  <!-- é¡µé¢å¼•å¯¼å¡ç‰‡ -->
  <page-header-guide 
    title="ä¸ªäººä¸­å¿ƒ"
    description="ç®¡ç†ä¸ªäººä¿¡æ¯ã€è”ç³»å®¢æœã€åˆ†äº«å°ç¨‹åºç­‰åŠŸèƒ½"
    tip="ğŸ’¡ æç¤ºï¼šç‚¹å‡»å¤´åƒå¯ä»¥ç™»å½•ï¼Œç‚¹å‡»åˆ†äº«å¯ä»¥é‚€è¯·æœ‹å‹ä½¿ç”¨"
    icon="ğŸ‘¤"
    storage-key="user-center-guide"
  />
  
  <view class="top_bg" />
  <view class="main_content">
    <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <view class="userinfo_container">
      <image class="avatar" src="../../images/icons/avatar.webp" bind:tap="getOpenId" mode="widthFix" />
      <block wx:if="{{ !isLoggedIn }}">
        <view class="username" bind:tap="getOpenId">è¯·ç‚¹å‡»ç™»å½•</view>
        <view class="user-desc">ç™»å½•åå¯æŸ¥çœ‹å­¦ä¹ ç»Ÿè®¡</view>
      </block>
      <block wx:else>
        <view class="username">å­¦ä¹ è¾¾äºº</view>
        <view class="user-desc">å·²å­¦ä¹  {{ studyStats.studyDays }} å¤©</view>
      </block>
    </view>

    <!-- å­¦ä¹ ç»Ÿè®¡åŒºåŸŸ -->
    <view class="stats_container" wx:if="{{ isLoggedIn }}">
      <view class="stats_title">å­¦ä¹ ç»Ÿè®¡</view>
      <view class="stats_grid">
        <view class="stat_item">
          <view class="stat_number">{{ studyStats.totalQuestions }}</view>
          <view class="stat_label">æ€»é¢˜ç›®</view>
        </view>
        <view class="stat_item">
          <view class="stat_number">{{ studyStats.accuracy }}%</view>
          <view class="stat_label">æ­£ç¡®ç‡</view>
        </view>
        <view class="stat_item">
          <view class="stat_number">{{ studyStats.todayQuestions }}</view>
          <view class="stat_label">ä»Šæ—¥ç»ƒä¹ </view>
        </view>
        <view class="stat_item">
          <view class="stat_number">{{ studyStats.wrongQuestions }}</view>
          <view class="stat_label">é”™é¢˜æ•°</view>
        </view>
      </view>
    </view>

    <!-- ä»Šæ—¥æˆå°±åŒºåŸŸ -->
    <view class="achievement-section" wx:if="{{ isLoggedIn }}">
      <view class="achievement-title">
        <view class="achievement-icon">ğŸ†</view>
        <view class="achievement-text">ä»Šæ—¥æˆå°±</view>
      </view>
      <view class="achievement-cards">
        <view class="achievement-card">
          <view class="achievement-number">{{todayStats.grammarCount}}</view>
          <view class="achievement-label">è¯­æ³•é¢˜</view>
        </view>
        <view class="achievement-card">
          <view class="achievement-number">{{todayStats.writingCount}}</view>
          <view class="achievement-label">ä¹¦å†™é¢˜</view>
        </view>
        <view class="achievement-card">
          <view class="achievement-number">{{todayStats.wrongQuestionCount}}</view>
          <view class="achievement-label">é”™é¢˜</view>
        </view>
        <view class="achievement-card" wx:if="{{todayStats.grammarLevel}}">
          <view class="achievement-level">{{todayStats.grammarLevelText}}</view>
          <view class="achievement-label">è¯­æ³•æ°´å¹³</view>
        </view>
      </view>
      <view class="achievement-progress" wx:if="{{todayStats.grammarCount > 0}}">
        <view class="progress-text">ä»Šæ—¥ç›®æ ‡ï¼š{{todayStats.grammarCount}}/20 é¢˜</view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progressWidth}}"></view>
        </view>
      </view>
    </view>

    <view class="settings_container">
      <view class="setting_item">
        <view class="left">
          <image class="setting_icon" src="../../images/icons/customer-service.svg" />
          <!-- ã€å·²æ›¿æ¢ã€‘åŸviewæ”¹ä¸ºbutton - ä½¿ç”¨å¾®ä¿¡åŸç”Ÿå®¢æœåŠŸèƒ½ï¼Œéœ€è¦buttonæ ‡ç­¾é…åˆopen-type="contact"å®ç° -->
          <!-- <view class="setting_text">è”ç³»å®¢æœ</view> -->
          <button open-type="contact" class="contact-button">
            è”ç³»å®¢æœ
          </button>
        </view>
        <image class="arrow_icon" src="../../images/arrow.svg" />
      </view>
      <view class="setting_item" bind:tap="goToJoinClass">
        <view class="left">
          <image class="setting_icon" src="../../images/icons/class.svg" />
          <view class="setting_text">åŠ å…¥ç­çº§</view>
        </view>
        <image class="arrow_icon" src="../../images/arrow.svg" />
      </view>
      <view class="setting_item" bind:tap="goToFeedback">
        <view class="left">
          <image class="setting_icon" src="../../images/icons/feedback.svg" />
          <view class="setting_text">æ„è§åé¦ˆ</view>
        </view>
        <image class="arrow_icon" src="../../images/arrow.svg" />
      </view>
      <view class="setting_item" bind:tap="gotoWxCodePage">
        <view class="left">
          <image class="setting_icon" src="../../images/icons/share.svg" />
          <view class="setting_text">åˆ†äº«å°ç¨‹åº</view>
        </view>
        <image class="arrow_icon" src="../../images/arrow.svg" />
      </view>
      <view class="setting_item" bind:tap="goToAdmin" wx:if="{{isAdmin}}">
        <view class="left">
          <image class="setting_icon" src="../../images/icons/admin.svg" />
          <view class="setting_text">åé¦ˆç®¡ç†</view>
        </view>
        <image class="arrow_icon" src="../../images/arrow.svg" />
      </view>
    </view>
  </view>
  <!-- ã€å·²åˆ é™¤ã€‘cloud-tip-modalç»„ä»¶ - äº‘å¼€å‘æç¤ºæ¨¡æ€æ¡†å·²ç§»é™¤ï¼Œä¸å†éœ€è¦æç¤ºç”¨æˆ·äº‘åŠŸèƒ½ -->

  <!-- æµ®åŠ¨åé¦ˆæŒ‰é’® -->
  <floating-feedback show="{{true}}" />
</view>
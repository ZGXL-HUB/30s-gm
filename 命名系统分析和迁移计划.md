# 命名系统分析和迁移计划

## 第一步：运行分析脚本

请在微信开发者工具控制台中运行：

```javascript
// 复制 comprehensive_naming_analysis.js 的全部内容到控制台
```

## 预期输出

脚本会输出以下信息：

### 1. 界面语法点列表
```
📱 界面显示的语法点:
介词 (3个小点):
  1. "介词综合"
  2. "固定搭配"
  3. "介词 + 名词/动名词"
代词 (6个小点):
  ...
总计: 12个大类, 40个小语法点
```

### 2. 云数据库分类分布
```
☁️ 云数据库实际分类:
category 字段分布:
   "介词(1)": 20 题
   "介词(2)": 18 题
   "介词综合": 25 题
   "代词(1)": 20 题
   ...
总计: X 个不同的 category

grammarPoint 字段分布:
   "介词综合": 15 题
   "固定搭配": 10 题
   ...
```

### 3. 命名匹配分析
```
🔍 命名匹配分析:
✅ "介词综合" (25题) - 在category中找到
✅ "固定搭配" (10题) - 在grammarPoint中找到
⚠️ "介词 + 名词/动名词" - 未精确匹配，可能的模糊匹配:
     category: [介词(3), 介词综合]
❌ "f/fe结尾" - 完全未找到
...
匹配统计:
   ✅ 精确匹配: 25/40 (62.5%)
   ❌ 未匹配: 15/40 (37.5%)
```

### 4. 建议的命名规范
```
💡 命名规范建议:
方案A: 分层命名（大类-小类）
   "介词综合" → "介词-综合"
   "介词 + 名词/动名词" → "介词-名词动名词"
```

## 第二步：根据分析结果制定方案

### 关键问题需要确认

1. **云数据库使用哪个字段**？
   - `category` 字段？（如 "介词(1)"）
   - `grammarPoint` 字段？（如 "介词综合"）
   - 还是两个都用？

2. **命名模式是什么**？
   - 编号模式："介词(1)", "介词(2)", "介词(3)"
   - 描述模式："介词综合", "固定搭配"
   - 还是混合使用？

3. **哪些语法点完全找不到**？
   - 这些需要优先处理
   - 可能需要添加题目或调整命名

## 第三步：根据分析制定详细迁移方案

### 情况A: 如果云数据库主要使用 category="介词(1)" 模式

**方案**: 
1. 界面保持友好命名（"介词综合"）
2. 云数据库添加 `displayName` 字段 = 界面名称
3. 查询时使用 displayName

**实施**:
```javascript
// 批量添加 displayName 字段
const nameMapping = {
  "介词(1)": "介词综合",
  "介词(2)": "固定搭配",
  "介词(3)": "介词-名词动名词",
  // ...
};

// 更新脚本
for (const [oldCat, newName] of Object.entries(nameMapping)) {
  await db.collection('questions')
    .where({ category: oldCat })
    .update({
      data: { displayName: newName }
    });
}
```

### 情况B: 如果云数据库主要使用 grammarPoint="介词综合" 模式

**方案**: 
1. 统一使用 grammarPoint 字段
2. 规范化 grammarPoint 的命名
3. 简化查询逻辑

**实施**:
```javascript
// 查询时直接使用 grammarPoint
const result = await db.collection('questions')
  .where({ grammarPoint: "介词综合" })
  .get();
```

### 情况C: 如果两个字段都有但不统一

**方案**: 
1. 定义主字段（建议用 grammarPoint）
2. 批量规范化主字段的值
3. category 作为备用字段

## 第四步：创建命名对照表

根据分析结果，我会创建一个完整的对照表：

```javascript
const namingConvention = {
  // 界面名称 → 云数据库标准名称
  
  // === 介词大类 ===
  "介词综合": "介词-综合",          // 或保持 "介词综合"
  "固定搭配": "介词-固定搭配",      // 或保持 "固定搭配"
  "介词 + 名词/动名词": "介词-名词动名词",  // 规范化特殊字符
  
  // === 代词大类 ===
  "代词综合": "代词-综合",
  "it相关": "代词-it用法",
  "人称代词": "代词-人称",
  "物主代词": "代词-物主",
  "反身代词": "代词-反身",
  "关系代词": "代词-关系",
  
  // === 时态大类 ===
  "时态(过去完成时)": "时态-过去完成时",  // 去掉括号
  "时态(过去进行时)": "时态-过去进行时",
  
  // === 副词大类 ===
  "副词修饰形容词/副词": "副词-修饰形容词副词",  // 去掉斜杠
  "副词修饰句子": "副词-修饰句子",
  
  // ... 全部40个
};
```

## 第五步：迁移实施

### 试验大类（建议：介词）

**为什么选介词**:
- 只有3个小点，最简单
- 测试各种命名情况
- 风险最小

**步骤**:
1. 更新界面显示（如果需要）
2. 更新云数据库的3个小点
3. 测试发布作业
4. 测试生成学案
5. 验证原题和变式题

## 📋 现在请您做什么

**立即行动**:

1. **在控制台运行 `comprehensive_naming_analysis.js`**
2. **将完整的输出结果复制给我**（特别是第2、3部分）
3. **我会根据实际情况给您定制化的迁移方案**

**我需要了解**:
- 云数据库实际使用哪个字段（category 还是 grammarPoint）
- 具体的命名模式是什么
- 哪些语法点能精确匹配，哪些不能

**然后我会**:
- 创建完整的40个语法点命名对照表
- 提供详细的迁移脚本
- 制定分步实施计划

---

**请运行分析脚本并把结果发给我！** 📊
